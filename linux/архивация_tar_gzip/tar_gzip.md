# Архивация файлов и каталогов

## Архивация отдельного файла со сжатием

Степень сжатия минимальная, зато быстро.

```sh
# Сжатие
gzip c1.json
gzip -k c1.json # Не удалять исходный файл после архивации

# Распаковка
gunzip c1.json.gz
gunzip -k c1.json.gz # Не удалять архив после распаковки
gunzip -f c1.json.gz # Форсировать замену существующих файлов
```

Параметры из диапазона от -1 до -9 позволяют задать степень сжатия (от самой
низкой до самой высокой соответственно), при этом чем выше степень сжатия, тем
больше системных ресурсов требуется утилите. Параметр -t предназначен для
тестирования целостности сжатого файла и не оказывает какого-либо влияния на
него (следует комбинировать его с параметром -v для подробного вывода).
Параметр -l также не оказывает никакого влияния на сжатый файл и предназначен
для получения информации об архиве (размеров сжатого и не сжатого файлов,
степени сжатия и имени оригинального файла). Параметр -d позволяет восстановить
оригинальные версии файлов с переданными именами на основе их сжатых версий.


## Архивация каталогов

Начнём с простого. Архивировать отдельную папку ./tree в архив tree.tar

```sh
tar -cvf tree.tar tree
# -f — на диске, а не на магнитной ленте, эта опция должна быть __последней__ при указании имени архива;
# -c — создать архив;
# -x — извлекать файлы из архива;
# -z — через gzip (.tar.gz, .tgz, .tar.gzip);
# -j — через bzip2 (.tar.bz2, .tar.bzip2, .tbz2, .tb2, .tbz);
# -v — вывод информации во время обработки;
# -t — просмотреть содержимое архива;
# -r — добавить в архив;
# -O, --to-stdout — extract files to standard output;
```

Архивировать несколько каталогов

```sh
tar -cvf fs.tar app const item tree
# или так, если всё в текущем каталоге
tar -cvf fs.tar ./*
```

Распаковка

```sh
tar -xvf tree.tar
```


## Архивация и распаковка огромных каталогов

```sh
tar -cvf - ./* | split -b 100m - fs.tar.
# Как видно имя файла пропущено в обеих командах (архивации и разбиения)
# установлен символ `-`, зато обозначен префикс `fs.tar.`, результатом будут
# файлы с именами fs.tar.aa fs.tar.ab fs.tar.ac и так далее.
# Со сжатием (-9 - максимальная степень сжатия - долго...)
GZIP=-9 tar -cvzf - ./* | split -b 10m - fs.tar.gz.

# Распаковка
cat fs.tar.* | tar -xvf -
# Со сжатием
cat fs.tar.gz.* | tar -xvzf -

# Разбить уже сформированный большой файл архива
# split [ПАРАМЕТР]… [ФАЙЛ [ПРЕФИКС]]
split -b 100m big.tar big.tar.
```
