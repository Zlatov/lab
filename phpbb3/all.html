<h2>Шаблоны</h2>
<h3>IF</h3>
<p><strong>Операторы:</strong></p>
<ul>
    <li><code>==</code></li>
    <li><code>!=</code></li>
    <li><code>&lt;&gt;</code> (то же что и <code>!=</code>)</li>
    <li><code>!==</code></li>
    <li><code>===</code></li>
    <li><code>&gt;</code></li>
    <li><code>&lt;</code></li>
    <li><code>&gt;=</code></li>
    <li><code>&lt;=</code></li>
    <li><code>&amp;&amp;</code></li>
    <li><code>||</code></li>
    <li><code>%</code> [mod]</li>
    <li><code>!</code> [not]</li>
    <li><code>+</code></li>
    <li><code>-</code></li>
    <li><code>*</code></li>
    <li><code>/</code></li>
    <li><code>&lt;&lt;</code> (bitwise shift left)</li>
    <li><code>&gt;&gt;</code> (bitwise shift right)</li>
    <li><code>|</code> (bitwise or)</li>
    <li><code>^</code> (bitwise xor)</li>
    <li><code>&amp;</code> (bitwise and)</li>
    <li><code>~</code> (bitwise not)</li>
    <li><code>is</code> (can be used to join comparison operations)</li>
</ul>
<p><strong>Конструкции:</strong></p>
<pre class="prettyprint lang-html">
&lt;!-- IF S_ACTION == 'create' --&gt;
    CREATE
&lt;!-- ELSEIF S_ACTION == 'index' --&gt;
    INDEX
&lt;!-- ENDIF --&gt;
</pre>

<h3>готовим вывод массива данных в шаблоне</h3>
<p>
    <a href="https://wiki.phpbb.com/Tutorial.Template_syntax" target="_blank">https://wiki.phpbb.com/Tutorial.Template_syntax</a>
</p>
<h2>Функции</h2>
<pre class="prettyprint lang-php">
$remote_addr = $request->variable('REMOTE_ADDR', '', false, \phpbb\request\request_interface::SERVER);
</pre>
<h2>Файловая структура</h2>
<pre>
adm/           = админка
assets/
bin/
cache/
config/
docs/
download/
ext/
files/
images/
includes/
install-/      = инсталяция и конвертация из другой версии
language/
phpbb/
store/
styles/        = стили (темы)
test/
vendor/
</pre>
<h2>Добавление своего</h2>
<h3>Модуля</h3>
<p><a href="https://wiki.phpbb.com/Creating_modules" target="_blank">https://wiki.phpbb.com/Creating_modules</a></p>
<p><strong>Файлы crud модераторского модуля:</strong></p>
<ul>
    <li><a href="codes/mcp_mod_crud.html"><code>includes/mcp/mcp_modcrud.php</code></a></li>
    <li><a href="codes/mcp_mod_crud_info.html"><code>includes/mcp/info/mcp_modcrud.php</code></a></li>
    <li><a href="codes/mcp_mod_crud_html.html"><code>styles/prosilver/template/mcp_modcrud_list.html</code></a></li>
</ul>
<h3>Правило/rule в ролях</h3>
<p>Вообще достаточно в базу добавить:</p>
<pre class="prettyprint lang-sql">INSERT INTO `forum_acl_options` (`auth_option_id`, `auth_option`, `is_global`, `is_local`, `founder_only`) VALUES (NULL, 'u_changereputation', '1', '0', '0');</pre>
и добавить языковой файл <var class="copyToClipboard">language/ru/mods/permissions_changereputation.php</var> (см другие шаблоны рядом):
<pre class="prettyprint lang-php">
&lt;?php
/**
* DO NOT CHANGE )))
*/
if (!defined('IN_PHPBB'))
{
    exit;
}

if (empty($lang) || !is_array($lang))
{
    $lang = array();
}

$lang = array_merge($lang, array(
    // 'ACL_CAT_REPUTATION'         =&gt; 'Репутация',
    // 'ACL_U_CHANGEREPUTATION'    =&gt; array('lang' =&gt; 'Может изменять репутацию', 'cat' =&gt; 'REPUTATION'),
    'ACL_U_CHANGEREPUTATION'    =&gt; 'Может изменять репутацию',
));
?&gt;
</pre>
<p>Однако есть дурацкая проверка в движке (<var class="copyToClipboard">phpbb/permissions.php</var>), тоесть получается дублирование инфы базы данных в файле:</p>
<pre class="prettyprint lang-php">
    public function permission_defined($permission)
    {
        return isset($this->permissions[$permission]);
    }

    ...

    protected $permissions = array(
        // User Permissions

        ...

        'u_changereputation' => array('lang' => 'ACL_U_CHANGEREPUTATION', 'cat' => 'misc'),

        ...

    );
</pre>
<div class="alert alert-info">
<p>Необходимо сбросить кеш вручную (файлы <var>data_acl_options.php</var>, <var>data_role_cache.php</var>)</p>
</div>
<h2>БД</h2>
<h3>Таблицы</h3>
<p><strong>Добавиьт свою Стандартную</strong></p>
<p><code>/includes/constants.php</code></p>
<h3>PHP функции для работы с БД</h3>
<p><a href="https://wiki.phpbb.com/Database_Abstraction_Layer">https://wiki.phpbb.com/Database_Abstraction_Layer</a></p>
<h3>Пользователь</h3>
<h4>Подтверждение email пользователя запросом</h4>
<pre class="prettyprint lang-sql">
UPDATE
    `forum_users`
SET
    `user_type` = 0,
    `user_inactive_reason` = 0,
    `user_inactive_time` = 0,
    `user_permissions` = ''
WHERE
    user_id = ...;
</pre>
<h4>Сделать пользователя основателем ресурса</h4>
<pre class="prettyprint lang-sql">
UPDATE
    `forum_users`
SET
    `user_type` = 3,
    `user_permissions` = ''
WHERE
    user_id = ...;
</pre>
<h2>Пользователь</h2>
<pre class="prettyprint lang-php">
if ($user->data['user_id'] == ANONYMOUS) {
   echo 'Please login!';
} else {
   echo 'Thanks for logging in, ' . $user->data['username_clean'];
}

define('IN_PHPBB', true);
$phpbb_root_path = (defined('PHPBB_ROOT_PATH')) ? PHPBB_ROOT_PATH : '../';
$phpEx = substr(strrchr(__FILE__, '.'), 1);
include($phpbb_root_path . 'common.' . $phpEx);
$user-&gt;session_begin();
echo &quot;&lt;pre&gt;&quot;;
print_r($user-&gt;data['session_id']);
echo &quot;&lt;/pre&gt;&quot;;
die();
</pre>